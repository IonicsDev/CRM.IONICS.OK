!function (e) { void 0 === e.fn.each2 && e.fn.extend({ each2: function (t) { for (var s = e([0]), i = -1, n = this.length; ++i < n && (s.context = s[0] = this[i]) && !1 !== t.call(s[0], i, s) ;); return this } }) }(jQuery), function (e, t) { "use strict"; if (window.Select2 === t) { var s, i, n, o, a, l, c, r, h, d = { TAB: 9, ENTER: 13, ESC: 27, SPACE: 32, LEFT: 37, UP: 38, RIGHT: 39, DOWN: 40, SHIFT: 16, CTRL: 17, ALT: 18, PAGE_UP: 33, PAGE_DOWN: 34, HOME: 36, END: 35, BACKSPACE: 8, DELETE: 46, isArrow: function (e) { switch (e = e.which ? e.which : e) { case d.LEFT: case d.RIGHT: case d.UP: case d.DOWN: return !0 } return !1 }, isControl: function (e) { switch (e.which) { case d.SHIFT: case d.CTRL: case d.ALT: return !0 } return !!e.metaKey }, isFunctionKey: function (e) { return (e = e.which ? e.which : e) >= 112 && e <= 123 } }, u = "<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>"; c = e(document), h = 1, o = function () { return h++ }, c.bind("mousemove", function (e) { l = { x: e.pageX, y: e.pageY } }), s = O(Object, { bind: function (e) { var t = this; return function () { e.apply(t, arguments) } }, init: function (s) { var i, n, a, c, h, d, f, g, m = ".select2-results"; this.opts = s = this.prepareOpts(s), this.id = s.id, s.element.data("select2") !== t && null !== s.element.data("select2") && this.destroy(), this.enabled = !0, this.container = this.createContainer(), this.containerId = "s2id_" + (s.element.attr("id") || "autogen" + o()), this.containerSelector = "#" + this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g, "\\$1"), this.container.attr("id", this.containerId), this.body = (a = function () { return s.element.closest("body") }, h = !1, function () { return !1 === h && (c = a(), h = !0), c }), S(this.container, this.opts.element, this.opts.adaptContainerCssClass), this.container.css(k(s.containerCss)), this.container.addClass(k(s.containerCssClass)), this.elementTabIndex = this.opts.element.attr("tabIndex"), this.opts.element.data("select2", this).addClass("select2-offscreen").bind("focus.select2", function () { e(this).select2("focus") }).attr("tabIndex", "-1").before(this.container), this.container.data("select2", this), this.dropdown = this.container.find(".select2-drop"), this.dropdown.addClass(k(s.dropdownCssClass)), this.dropdown.data("select2", this), this.results = i = this.container.find(m), this.search = n = this.container.find("input.select2-input"), n.attr("tabIndex", this.elementTabIndex), this.resultsPage = 0, this.context = null, this.initContainer(), this.results.bind("mousemove", function (s) { var i = l; i !== t && i.x === s.pageX && i.y === s.pageY || e(s.target).trigger("mousemove-filtered", s) }), this.dropdown.delegate(m, "mousemove-filtered touchstart touchmove touchend", this.bind(this.highlightUnderEvent)), d = 80, f = this.results, g = b(d, function (e) { f.trigger("scroll-debounced", e) }), f.bind("scroll", function (e) { p(e.target, f.get()) >= 0 && g(e) }), this.dropdown.delegate(m, "scroll-debounced", this.bind(this.loadMoreIfNeeded)), e.fn.mousewheel && i.mousewheel(function (e, t, s, n) { var o = i.scrollTop(); n > 0 && o - n <= 0 ? (i.scrollTop(0), C(e)) : n < 0 && i.get(0).scrollHeight - i.scrollTop() + n <= i.height() && (i.scrollTop(i.get(0).scrollHeight - i.height()), C(e)) }), v(n), n.bind("keyup-change input paste", this.bind(this.updateResults)), n.bind("focus", function () { n.addClass("select2-focused") }), n.bind("blur", function () { n.removeClass("select2-focused") }), this.dropdown.delegate(m, "mouseup", this.bind(function (t) { e(t.target).closest(".select2-result-selectable").length > 0 && (this.highlightUnderEvent(t), this.selectHighlighted(t)) })), this.dropdown.bind("click mouseup mousedown", function (e) { e.stopPropagation() }), e.isFunction(this.opts.initSelection) && (this.initSelection(), this.monitorSource()), (s.element.is(":disabled") || s.element.is("[readonly='readonly']")) && this.disable(), r = r || function () { var t = e(u); t.appendTo("body"); var s = { width: t.width() - t[0].clientWidth, height: t.height() - t[0].clientHeight }; return t.remove(), s }() }, destroy: function () { var e = this.opts.element.data("select2"); this.propertyObserver && (delete this.propertyObserver, this.propertyObserver = null), e !== t && (e.container.remove(), e.dropdown.remove(), e.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({ tabIndex: this.elementTabIndex }).show()) }, prepareOpts: function (s) { var i, n, o, a; if ("select" === (i = s.element).get(0).tagName.toLowerCase() && (this.select = n = s.element), n && e.each(["id", "multiple", "ajax", "query", "createSearchChoice", "initSelection", "data", "tags"], function () { if (this in s) throw new Error("Option '" + this + "' is not allowed for Select2 when attached to a <select> element.") }), "function" != typeof (s = e.extend({}, { populateResults: function (i, n, o) { var a, l = this.opts.id, c = this; (a = function (i, n, r) { var h, d, u, p, f, g, m, v, b, w; for (h = 0, d = (i = s.sortResults(i, n, o)).length; h < d; h += 1) p = !(f = !0 === (u = i[h]).disabled) && l(u) !== t, g = u.children && u.children.length > 0, (m = e("<li></li>")).addClass("select2-results-dept-" + r), m.addClass("select2-result"), m.addClass(p ? "select2-result-selectable" : "select2-result-unselectable"), f && m.addClass("select2-disabled"), g && m.addClass("select2-result-with-children"), m.addClass(c.opts.formatResultCssClass(u)), (v = e(document.createElement("div"))).addClass("select2-result-label"), (w = s.formatResult(u, v, o, c.opts.escapeMarkup)) !== t && v.html(w), m.append(v), g && ((b = e("<ul></ul>")).addClass("select2-result-sub"), a(u.children, b, r + 1), m.append(b)), m.data("select2-data", u), n.append(m) })(n, i, 0) } }, e.fn.select2.defaults, s)).id && (o = s.id, s.id = function (e) { return e[o] }), e.isArray(s.element.data("select2Tags"))) { if ("tags" in s) throw "tags specified as both an attribute 'data-select2-tags' and in options of Select2 " + s.element.attr("id"); s.tags = s.element.data("select2Tags") } if (n ? (s.query = this.bind(function (s) { var n, o, a, l = { results: [], more: !1 }, c = s.term; a = function (e, t) { var i; e.is("option") ? s.matcher(c, e.text(), e) && t.push({ id: e.attr("value"), text: e.text(), element: e.get(), css: e.attr("class"), disabled: f(e.attr("disabled"), "disabled") }) : e.is("optgroup") && (i = { text: e.attr("label"), children: [], element: e.get(), css: e.attr("class") }, e.children().each2(function (e, t) { a(t, i.children) }), i.children.length > 0 && t.push(i)) }, n = i.children(), this.getPlaceholder() !== t && n.length > 0 && (o = n[0], "" === e(o).text() && (n = n.not(o))), n.each2(function (e, t) { a(t, l.results) }), s.callback(l) }), s.id = function (e) { return e.id }, s.formatResultCssClass = function (e) { return e.css }) : "query" in s || ("ajax" in s ? ((a = s.element.data("ajax-url")) && a.length > 0 && (s.ajax.url = a), s.query = x.call(s.element, s.ajax)) : "data" in s ? s.query = E(s.data) : "tags" in s && (s.query = T(s.tags), s.createSearchChoice === t && (s.createSearchChoice = function (e) { return { id: e, text: e } }), s.initSelection === t && (s.initSelection = function (t, i) { var n = []; e(g(t.val(), s.separator)).each(function () { var t = this, i = this, o = s.tags; e.isFunction(o) && (o = o()), e(o).each(function () { if (f(this.id, t)) return i = this.text, !1 }), n.push({ id: t, text: i }) }), i(n) }))), "function" != typeof s.query) throw "query function not defined for Select2 " + s.element.attr("id"); return s }, monitorSource: function () { var e, t = this.opts.element; t.bind("change.select2", this.bind(function (e) { !0 !== this.opts.element.data("select2-change-triggered") && this.initSelection() })), e = this.bind(function () { var e, t; e = "disabled" !== this.opts.element.attr("disabled"), t = "readonly" === this.opts.element.attr("readonly"), e = e && !t, this.enabled !== e && (e ? this.enable() : this.disable()), S(this.container, this.opts.element, this.opts.adaptContainerCssClass), this.container.addClass(k(this.opts.containerCssClass)), S(this.dropdown, this.opts.element, this.opts.adaptDropdownCssClass), this.dropdown.addClass(k(this.opts.dropdownCssClass)) }), t.bind("propertychange.select2 DOMAttrModified.select2", e), "undefined" != typeof WebKitMutationObserver && (this.propertyObserver && (delete this.propertyObserver, this.propertyObserver = null), this.propertyObserver = new WebKitMutationObserver(function (t) { t.forEach(e) }), this.propertyObserver.observe(t.get(0), { attributes: !0, subtree: !1 })) }, triggerChange: function (t) { t = t || {}, t = e.extend({}, t, { type: "change", val: this.val() }), this.opts.element.data("select2-change-triggered", !0), this.opts.element.trigger(t), this.opts.element.data("select2-change-triggered", !1), this.opts.element.click(), this.opts.blurOnChange && this.opts.element.blur() }, enable: function () { this.enabled || (this.enabled = !0, this.container.removeClass("select2-container-disabled"), this.opts.element.removeAttr("disabled")) }, disable: function () { this.enabled && (this.close(), this.enabled = !1, this.container.addClass("select2-container-disabled"), this.opts.element.attr("disabled", "disabled")) }, opened: function () { return this.container.hasClass("select2-dropdown-open") }, positionDropdown: function () { var t, s, i, n, o = this.dropdown, a = this.container.offset(), l = this.container.outerHeight(!1), c = this.container.outerWidth(!1), h = o.outerHeight(!1), d = e(window).scrollLeft() + e(window).width(), u = e(window).scrollTop() + e(window).height(), p = a.top + l, f = a.left, g = p + h <= u, m = a.top - h >= this.body().scrollTop(), v = o.outerWidth(!1), b = f + v <= d, w = o.hasClass("select2-drop-above"); this.opts.dropdownAutoWidth ? (n = e(".select2-results", o)[0], o.addClass("select2-drop-auto-width"), o.css("width", ""), (v = o.outerWidth(!1) + (n.scrollHeight === n.clientHeight ? 0 : r.width)) > c ? c = v : v = c, b = f + v <= d) : this.container.removeClass("select2-drop-auto-width"), "static" !== this.body().css("position") && (p -= (t = this.body().offset()).top, f -= t.left), w ? (s = !0, !m && g && (s = !1)) : (s = !1, !g && m && (s = !0)), b || (f = a.left + c - v), s ? (p = a.top - h, this.container.addClass("select2-drop-above"), o.addClass("select2-drop-above")) : (this.container.removeClass("select2-drop-above"), o.removeClass("select2-drop-above")), i = e.extend({ top: p, left: f, width: c }, k(this.opts.dropdownCss)), o.css(i) }, shouldOpen: function () { var t; return !this.opened() && (t = e.Event("opening"), this.opts.element.trigger(t), !t.isDefaultPrevented()) }, clearDropdownAlignmentPreference: function () { this.container.removeClass("select2-drop-above"), this.dropdown.removeClass("select2-drop-above") }, open: function () { return !!this.shouldOpen() && (window.setTimeout(this.bind(this.opening), 1), !0) }, opening: function () { var t, s = this.containerId, i = "scroll." + s, n = "resize." + s, o = "orientationchange." + s; this.clearDropdownAlignmentPreference(), this.container.addClass("select2-dropdown-open").addClass("select2-container-active"), this.dropdown[0] !== this.body().children().last()[0] && this.dropdown.detach().appendTo(this.body()), this.updateResults(!0), 0 === (t = e("#select2-drop-mask")).length && ((t = e(document.createElement("div"))).attr("id", "select2-drop-mask").attr("class", "select2-drop-mask"), t.hide(), t.appendTo(this.body()), t.bind("mousedown touchstart", function (t) { var s, i = e("#select2-drop"); i.length > 0 && ((s = i.data("select2")).opts.selectOnBlur && s.selectHighlighted({ noFocus: !0 }), s.close()) })), this.dropdown.prev()[0] !== t[0] && this.dropdown.before(t), e("#select2-drop").removeAttr("id"), this.dropdown.attr("id", "select2-drop"), t.css(l()), t.show(), this.dropdown.show(), this.positionDropdown(), this.dropdown.addClass("select2-drop-active"), this.ensureHighlightVisible(); var a = this; function l() { return { width: Math.max(document.documentElement.scrollWidth, e(window).width()), height: Math.max(document.documentElement.scrollHeight, e(window).height()) } } this.container.parents().add(window).each(function () { e(this).bind(n + " " + i + " " + o, function (t) { e("#select2-drop-mask").css(l()), a.positionDropdown() }) }), this.focusSearch() }, close: function () { if (this.opened()) { var t = this.containerId, s = "scroll." + t, i = "resize." + t, n = "orientationchange." + t; this.container.parents().add(window).each(function () { e(this).unbind(s).unbind(i).unbind(n) }), this.clearDropdownAlignmentPreference(), e("#select2-drop-mask").hide(), this.dropdown.removeAttr("id"), this.dropdown.hide(), this.container.removeClass("select2-dropdown-open"), this.results.empty(), this.clearSearch(), this.search.removeClass("select2-active"), this.opts.element.trigger(e.Event("close")) } }, clearSearch: function () { }, getMaximumSelectionSize: function () { return k(this.opts.maximumSelectionSize) }, ensureHighlightVisible: function () { var t, s, i, n, o, a, l, c = this.results; (s = this.highlight()) < 0 || (0 !== s ? (t = this.findHighlightableChoices().find(".select2-result-label"), n = (i = e(t[s])).offset().top + i.outerHeight(!0), s === t.length - 1 && (l = c.find("li.select2-more-results")).length > 0 && (n = l.offset().top + l.outerHeight(!0)), n > (o = c.offset().top + c.outerHeight(!0)) && c.scrollTop(c.scrollTop() + (n - o)), (a = i.offset().top - c.offset().top) < 0 && "none" !== i.css("display") && c.scrollTop(c.scrollTop() + a)) : c.scrollTop(0)) }, findHighlightableChoices: function () { return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)") }, moveHighlight: function (t) { for (var s = this.findHighlightableChoices(), i = this.highlight() ; i > -1 && i < s.length;) { var n = e(s[i += t]); if (n.hasClass("select2-result-selectable") && !n.hasClass("select2-disabled") && !n.hasClass("select2-selected")) { this.highlight(i); break } } }, highlight: function (t) { var s, i, n = this.findHighlightableChoices(); if (0 === arguments.length) return p(n.filter(".select2-highlighted")[0], n.get()); t >= n.length && (t = n.length - 1), t < 0 && (t = 0), this.results.find(".select2-highlighted").removeClass("select2-highlighted"), (s = e(n[t])).addClass("select2-highlighted"), this.ensureHighlightVisible(), (i = s.data("select2-data")) && this.opts.element.trigger({ type: "highlight", val: this.id(i), choice: i }) }, countSelectableResults: function () { return this.findHighlightableChoices().length }, highlightUnderEvent: function (t) { var s = e(t.target).closest(".select2-result-selectable"); if (s.length > 0 && !s.is(".select2-highlighted")) { var i = this.findHighlightableChoices(); this.highlight(i.index(s)) } else 0 === s.length && this.results.find(".select2-highlighted").removeClass("select2-highlighted") }, loadMoreIfNeeded: function () { var e = this.results, t = e.find("li.select2-more-results"), s = this.resultsPage + 1, i = this, n = this.search.val(), o = this.context; 0 !== t.length && t.offset().top - e.offset().top - e.height() <= this.opts.loadMorePadding && (t.addClass("select2-active"), this.opts.query({ element: this.opts.element, term: n, page: s, context: o, matcher: this.opts.matcher, callback: this.bind(function (a) { i.opened() && (i.opts.populateResults.call(this, e, a.results, { term: n, page: s, context: o }), i.postprocessResults(a, !1, !1), !0 === a.more ? (t.detach().appendTo(e).text(i.opts.formatLoadMore(s + 1)), window.setTimeout(function () { i.loadMoreIfNeeded() }, 10)) : t.remove(), i.positionDropdown(), i.resultsPage = s, i.context = a.context) }) })) }, tokenize: function () { }, updateResults: function (s) { var i, n, o = this.search, a = this.results, l = this.opts, c = this, r = o.val(), h = e.data(this.container, "select2-last-term"); if ((!0 === s || !h || !f(r, h)) && (e.data(this.container, "select2-last-term", r), !0 === s || !1 !== this.showSearchInput && this.opened())) { var d = this.getMaximumSelectionSize(); d >= 1 && (i = this.data(), e.isArray(i) && i.length >= d && P(l.formatSelectionTooBig)) ? p("<li class='select2-selection-limit'>" + l.formatSelectionTooBig(d) + "</li>") : o.val().length < l.minimumInputLength ? P(l.formatInputTooShort) ? p("<li class='select2-no-results'>" + l.formatInputTooShort(o.val(), l.minimumInputLength) + "</li>") : p("") : l.maximumInputLength && o.val().length > l.maximumInputLength ? P(l.formatInputTooLong) ? p("<li class='select2-no-results'>" + l.formatInputTooLong(o.val(), l.maximumInputLength) + "</li>") : p("") : (l.formatSearching && 0 === this.findHighlightableChoices().length && p("<li class='select2-searching'>" + l.formatSearching() + "</li>"), o.addClass("select2-active"), (n = this.tokenize()) !== t && null !== n && o.val(n), this.resultsPage = 1, l.query({ element: l.element, term: o.val(), page: this.resultsPage, context: null, matcher: l.matcher, callback: this.bind(function (i) { var n; this.opened() ? (this.context = i.context === t ? null : i.context, this.opts.createSearchChoice && "" !== o.val() && (n = this.opts.createSearchChoice.call(null, o.val(), i.results)) !== t && null !== n && c.id(n) !== t && null !== c.id(n) && 0 === e(i.results).filter(function () { return f(c.id(this), c.id(n)) }).length && i.results.unshift(n), 0 === i.results.length && P(l.formatNoMatches) ? p("<li class='select2-no-results'>" + l.formatNoMatches(o.val()) + "</li>") : (a.empty(), c.opts.populateResults.call(this, a, i.results, { term: o.val(), page: this.resultsPage, context: null }), !0 === i.more && P(l.formatLoadMore) && (a.append("<li class='select2-more-results'>" + c.opts.escapeMarkup(l.formatLoadMore(this.resultsPage)) + "</li>"), window.setTimeout(function () { c.loadMoreIfNeeded() }, 10)), this.postprocessResults(i, s), u(), this.opts.element.trigger({ type: "loaded", data: i }))) : this.search.removeClass("select2-active") }) })) } function u() { a.scrollTop(0), o.removeClass("select2-active"), c.positionDropdown() } function p(e) { a.html(e), u() } }, cancel: function () { this.close() }, blur: function () { this.opts.selectOnBlur && this.selectHighlighted({ noFocus: !0 }), this.close(), this.container.removeClass("select2-container-active"), this.search[0] === document.activeElement && this.search.blur(), this.clearSearch(), this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus") }, focusSearch: function () { w(this.search) }, selectHighlighted: function (e) { var t = this.highlight(), s = this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data"); s && (this.highlight(t), this.onSelect(s, e)) }, getPlaceholder: function () { return this.opts.element.attr("placeholder") || this.opts.element.attr("data-placeholder") || this.opts.element.data("placeholder") || this.opts.placeholder }, initContainerWidth: function () { var s = function () { var s, i, n, o, a; if ("off" === this.opts.width) return null; if ("element" === this.opts.width) return 0 === this.opts.element.outerWidth(!1) ? "auto" : this.opts.element.outerWidth(!1) + "px"; if ("copy" === this.opts.width || "resolve" === this.opts.width) { if ((s = this.opts.element.attr("style")) !== t) for (o = 0, a = (i = s.split(";")).length; o < a; o += 1) if (null !== (n = i[o].replace(/\s/g, "").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/)) && n.length >= 1) return n[1]; return "resolve" === this.opts.width ? (s = this.opts.element.css("width")).indexOf("%") > 0 ? s : 0 === this.opts.element.outerWidth(!1) ? "auto" : this.opts.element.outerWidth(!1) + "px" : null } return e.isFunction(this.opts.width) ? this.opts.width() : this.opts.width }.call(this); null !== s && this.container.css("width", s) } }), i = O(s, { createContainer: function () { return e(document.createElement("div")).attr({ class: "select2-container" }).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>", "   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>", "   <div><b></b></div>", "</a>", "<input class='select2-focusser select2-offscreen' type='text'/>", "<div class='select2-drop' style='display:none'>", "   <div class='select2-search'>", "       <input type='text' autocomplete='off' class='select2-input'/>", "   </div>", "   <ul class='select2-results'>", "   </ul>", "</div>"].join("")) }, disable: function () { this.enabled && (this.parent.disable.apply(this, arguments), this.focusser.attr("disabled", "disabled")) }, enable: function () { this.enabled || (this.parent.enable.apply(this, arguments), this.focusser.removeAttr("disabled")) }, opening: function () { this.parent.opening.apply(this, arguments), this.focusser.attr("disabled", "disabled"), this.opts.element.trigger(e.Event("open")) }, close: function () { this.opened() && (this.parent.close.apply(this, arguments), this.focusser.removeAttr("disabled"), w(this.focusser)) }, focus: function () { this.opened() ? this.close() : (this.focusser.removeAttr("disabled"), this.focusser.focus()) }, isFocused: function () { return this.container.hasClass("select2-container-active") }, cancel: function () { this.parent.cancel.apply(this, arguments), this.focusser.removeAttr("disabled"), this.focusser.focus() }, initContainer: function () { var t, s = this.container, i = this.dropdown; this.showSearch(this.opts.minimumResultsForSearch >= 0), this.selection = t = s.find(".select2-choice"), this.focusser = s.find(".select2-focusser"), this.focusser.attr("id", "s2id_autogen" + o()), e("label[for='" + this.opts.element.attr("id") + "']").attr("for", this.focusser.attr("id")), this.search.bind("keydown", this.bind(function (e) { if (this.enabled) if (e.which !== d.PAGE_UP && e.which !== d.PAGE_DOWN) switch (e.which) { case d.UP: case d.DOWN: return this.moveHighlight(e.which === d.UP ? -1 : 1), void C(e); case d.TAB: case d.ENTER: return this.selectHighlighted(), void C(e); case d.ESC: return this.cancel(e), void C(e) } else C(e) })), this.search.bind("blur", this.bind(function (e) { document.activeElement === this.body().get(0) && window.setTimeout(this.bind(function () { this.search.focus() }), 0) })), this.focusser.bind("keydown", this.bind(function (e) { if (this.enabled && e.which !== d.TAB && !d.isControl(e) && !d.isFunctionKey(e) && e.which !== d.ESC) { if (!1 !== this.opts.openOnEnter || e.which !== d.ENTER) return e.which === d.DOWN || e.which === d.UP || e.which === d.ENTER && this.opts.openOnEnter ? (this.open(), void C(e)) : e.which === d.DELETE || e.which === d.BACKSPACE ? (this.opts.allowClear && this.clear(), void C(e)) : void 0; C(e) } })), v(this.focusser), this.focusser.bind("keyup-change input", this.bind(function (e) { this.opened() || (this.open(), !1 !== this.showSearchInput && this.search.val(this.focusser.val()), this.focusser.val(""), C(e)) })), t.delegate("abbr", "mousedown", this.bind(function (e) { var t; this.enabled && (this.clear(), (t = e).preventDefault(), t.stopImmediatePropagation(), this.close(), this.selection.focus()) })), t.bind("mousedown", this.bind(function (e) { !0, this.opened() ? this.close() : this.enabled && this.open(), C(e), !1 })), i.bind("mousedown", this.bind(function () { this.search.focus() })), t.bind("focus", this.bind(function (e) { C(e) })), this.focusser.bind("focus", this.bind(function () { this.container.addClass("select2-container-active") })).bind("blur", this.bind(function () { this.opened() || this.container.removeClass("select2-container-active") })), this.search.bind("focus", this.bind(function () { this.container.addClass("select2-container-active") })), this.initContainerWidth(), this.setPlaceholder() }, clear: function (e) { var t = this.selection.data("select2-data"); t && (this.opts.element.val(""), this.selection.find("span").empty(), this.selection.removeData("select2-data"), this.setPlaceholder(), !1 !== e && (this.opts.element.trigger({ type: "removed", val: this.id(t), choice: t }), this.triggerChange({ removed: t }))) }, initSelection: function () { if ("" === this.opts.element.val() && "" === this.opts.element.text()) this.close(), this.setPlaceholder(); else { var e = this; this.opts.initSelection.call(null, this.opts.element, function (s) { s !== t && null !== s && (e.updateSelection(s), e.close(), e.setPlaceholder()) }) } }, prepareOpts: function () { var t = this.parent.prepareOpts.apply(this, arguments); return "select" === t.element.get(0).tagName.toLowerCase() ? t.initSelection = function (t, s) { var i = t.find(":selected"); e.isFunction(s) && s({ id: i.attr("value"), text: i.text(), element: i }) } : "data" in t && (t.initSelection = t.initSelection || function (s, i) { var n = s.val(), o = null; t.query({ matcher: function (e, s, i) { var a = f(n, t.id(i)); return a && (o = i), a }, callback: e.isFunction(i) ? function () { i(o) } : e.noop }) }), t }, getPlaceholder: function () { return this.select && "" !== this.select.find("option").first().text() ? t : this.parent.getPlaceholder.apply(this, arguments) }, setPlaceholder: function () { var e = this.getPlaceholder(); if ("" === this.opts.element.val() && e !== t) { if (this.select && "" !== this.select.find("option:first").text()) return; this.selection.find("span").html(this.opts.escapeMarkup(e)), this.selection.addClass("select2-default"), this.selection.find("abbr").hide() } }, postprocessResults: function (t, s, i) { var n = 0, o = this, a = !0; if (this.findHighlightableChoices().each2(function (e, t) { if (f(o.id(t.data("select2-data")), o.opts.element.val())) return n = e, !1 }), !1 !== i && this.highlight(n), !0 === s) { var l = this.opts.minimumResultsForSearch; a = !(l < 0) && function t(s) { var i = 0; return e.each(s, function (e, s) { s.children ? i += t(s.children) : i++ }), i }(t.results) >= l, this.showSearch(a) } }, showSearch: function (t) { this.showSearchInput = t, this.dropdown.find(".select2-search")[t ? "removeClass" : "addClass"]("select2-search-hidden"), e(this.dropdown, this.container)[t ? "addClass" : "removeClass"]("select2-with-searchbox") }, onSelect: function (e, t) { var s = this.opts.element.val(); this.opts.element.val(this.id(e)), this.updateSelection(e), this.opts.element.trigger({ type: "selected", val: this.id(e), choice: e }), this.close(), t && t.noFocus || this.selection.focus(), f(s, this.id(e)) || this.triggerChange() }, updateSelection: function (e) { var s, i = this.selection.find("span"); this.selection.data("select2-data", e), i.empty(), (s = this.opts.formatSelection(e, i)) !== t && i.append(this.opts.escapeMarkup(s)), this.selection.removeClass("select2-default"), this.opts.allowClear && this.getPlaceholder() !== t && this.selection.find("abbr").show() }, val: function () { var e, s = !1, i = null, n = this; if (0 === arguments.length) return this.opts.element.val(); if (e = arguments[0], arguments.length > 1 && (s = arguments[1]), this.select) this.select.val(e).find(":selected").each2(function (e, t) { return i = { id: t.attr("value"), text: t.text(), element: t.get(0) }, !1 }), this.updateSelection(i), this.setPlaceholder(), s && this.triggerChange(); else { if (this.opts.initSelection === t) throw new Error("cannot call val() if initSelection() is not defined"); if (!e && 0 !== e) return this.clear(s), void (s && this.triggerChange()); this.opts.element.val(e), this.opts.initSelection(this.opts.element, function (e) { n.opts.element.val(e ? n.id(e) : ""), n.updateSelection(e), n.setPlaceholder(), s && n.triggerChange() }) } }, clearSearch: function () { this.search.val(""), this.focusser.val("") }, data: function (e) { var s; if (0 === arguments.length) return (s = this.selection.data("select2-data")) === t && (s = null), s; e && "" !== e ? (this.opts.element.val(e ? this.id(e) : ""), this.updateSelection(e)) : this.clear() } }), n = O(s, { createContainer: function () { return e(document.createElement("div")).attr({ class: "select2-container select2-container-multi" }).html(["    <ul class='select2-choices'>", "  <li class='select2-search-field'>", "    <input type='text' autocomplete='off' class='select2-input'>", "  </li>", "</ul>", "<div class='select2-drop select2-drop-multi' style='display:none;'>", "   <ul class='select2-results'>", "   </ul>", "</div>"].join("")) }, prepareOpts: function () { var t = this.parent.prepareOpts.apply(this, arguments); return "select" === t.element.get(0).tagName.toLowerCase() ? t.initSelection = function (e, t) { var s = []; e.find(":selected").each2(function (e, t) { s.push({ id: t.attr("value"), text: t.text(), element: t[0] }) }), t(s) } : "data" in t && (t.initSelection = t.initSelection || function (s, i) { var n = g(s.val(), t.separator), o = []; t.query({ matcher: function (s, i, a) { var l = e.grep(n, function (e) { return f(e, t.id(a)) }).length; return l && o.push(a), l }, callback: e.isFunction(i) ? function () { i(o) } : e.noop }) }), t }, initContainer: function () { var t, s = ".select2-choices"; this.searchContainer = this.container.find(".select2-search-field"), this.selection = t = this.container.find(s), this.search.attr("id", "s2id_autogen" + o()), e("label[for='" + this.opts.element.attr("id") + "']").attr("for", this.search.attr("id")), this.search.bind("input paste", this.bind(function () { this.enabled && (this.opened() || this.open()) })), this.search.bind("keydown", this.bind(function (e) { if (this.enabled) { if (e.which === d.BACKSPACE && "" === this.search.val()) { this.close(); var s, i = t.find(".select2-search-choice-focus"); if (i.length > 0) return this.unselect(i.first()), this.search.width(10), void C(e); (s = t.find(".select2-search-choice:not(.select2-locked)")).length > 0 && s.last().addClass("select2-search-choice-focus") } else t.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"); if (this.opened()) switch (e.which) { case d.UP: case d.DOWN: return this.moveHighlight(e.which === d.UP ? -1 : 1), void C(e); case d.ENTER: case d.TAB: return this.selectHighlighted(), void C(e); case d.ESC: return this.cancel(e), void C(e) } if (e.which !== d.TAB && !d.isControl(e) && !d.isFunctionKey(e) && e.which !== d.BACKSPACE && e.which !== d.ESC) { if (e.which === d.ENTER) { if (!1 === this.opts.openOnEnter) return; if (e.altKey || e.ctrlKey || e.shiftKey || e.metaKey) return } this.open(), e.which !== d.PAGE_UP && e.which !== d.PAGE_DOWN || C(e), e.which === d.ENTER && C(e) } } })), this.search.bind("keyup", this.bind(this.resizeSearch)), this.search.bind("blur", this.bind(function (e) { this.container.removeClass("select2-container-active"), this.search.removeClass("select2-focused"), this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"), this.opened() || this.clearSearch(), e.stopImmediatePropagation() })), this.container.delegate(s, "mousedown", this.bind(function (t) { this.enabled && (e(t.target).closest(".select2-search-choice").length > 0 || (this.clearPlaceholder(), this.open(), this.focusSearch(), t.preventDefault())) })), this.container.delegate(s, "focus", this.bind(function () { this.enabled && (this.container.addClass("select2-container-active"), this.dropdown.addClass("select2-drop-active"), this.clearPlaceholder()) })), this.initContainerWidth(), this.clearSearch() }, enable: function () { this.enabled || (this.parent.enable.apply(this, arguments), this.search.removeAttr("disabled")) }, disable: function () { this.enabled && (this.parent.disable.apply(this, arguments), this.search.attr("disabled", !0)) }, initSelection: function () { if ("" === this.opts.element.val() && "" === this.opts.element.text() && (this.updateSelection([]), this.close(), this.clearSearch()), this.select || "" !== this.opts.element.val()) { var e = this; this.opts.initSelection.call(null, this.opts.element, function (s) { s !== t && null !== s && (e.updateSelection(s), e.close(), e.clearSearch()) }) } }, clearSearch: function () { var e = this.getPlaceholder(); e !== t && 0 === this.getVal().length && !1 === this.search.hasClass("select2-focused") ? (this.search.val(e).addClass("select2-default"), this.search.width(this.getMaxSearchWidth())) : this.search.val("").width(10) }, clearPlaceholder: function () { this.search.hasClass("select2-default") && this.search.val("").removeClass("select2-default") }, opening: function () { this.clearPlaceholder(), this.resizeSearch(), this.parent.opening.apply(this, arguments), this.focusSearch(), this.opts.element.trigger(e.Event("open")) }, close: function () { this.opened() && this.parent.close.apply(this, arguments) }, focus: function () { this.close(), this.search.focus() }, isFocused: function () { return this.search.hasClass("select2-focused") }, updateSelection: function (t) { var s = [], i = [], n = this; e(t).each(function () { p(n.id(this), s) < 0 && (s.push(n.id(this)), i.push(this)) }), t = i, this.selection.find(".select2-search-choice").remove(), e(t).each(function () { n.addSelectedChoice(this) }), n.postprocessResults() }, tokenize: function () { var e = this.search.val(); null !== (e = this.opts.tokenizer(e, this.data(), this.bind(this.onSelect), this.opts)) && e !== t && (this.search.val(e), e.length > 0 && this.open()) }, onSelect: function (e, t) { this.addSelectedChoice(e), this.opts.element.trigger({ type: "selected", val: this.id(e), choice: e }), !this.select && this.opts.closeOnSelect || this.postprocessResults(), this.opts.closeOnSelect ? (this.close(), this.search.width(10)) : this.countSelectableResults() > 0 ? (this.search.width(10), this.resizeSearch(), this.getMaximumSelectionSize() > 0 && this.val().length >= this.getMaximumSelectionSize() && this.updateResults(!0), this.positionDropdown()) : (this.close(), this.search.width(10)), this.triggerChange({ added: e }), t && t.noFocus || this.focusSearch() }, cancel: function () { this.close(), this.focusSearch() }, addSelectedChoice: function (s) { var i, n = !s.locked, o = e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"), a = e("<li class='select2-search-choice select2-locked'><div></div></li>"), l = n ? o : a, c = this.id(s), r = this.getVal(); (i = this.opts.formatSelection(s, l.find("div"))) !== t && l.find("div").replaceWith("<div>" + this.opts.escapeMarkup(i) + "</div>"), n && l.find(".select2-search-choice-close").bind("mousedown", C).bind("click dblclick", this.bind(function (t) { this.enabled && (e(t.target).closest(".select2-search-choice").fadeOut("fast", this.bind(function () { this.unselect(e(t.target)), this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"), this.close(), this.focusSearch() })).dequeue(), C(t)) })).bind("focus", this.bind(function () { this.enabled && (this.container.addClass("select2-container-active"), this.dropdown.addClass("select2-drop-active")) })), l.data("select2-data", s), l.insertBefore(this.searchContainer), r.push(c), this.setVal(r) }, unselect: function (e) { var t, s, i = this.getVal(); if (0 === (e = e.closest(".select2-search-choice")).length) throw "Invalid argument: " + e + ". Must be .select2-search-choice"; (t = e.data("select2-data")) && ((s = p(this.id(t), i)) >= 0 && (i.splice(s, 1), this.setVal(i), this.select && this.postprocessResults()), e.remove(), this.opts.element.trigger({ type: "removed", val: this.id(t), choice: t }), this.triggerChange({ removed: t })) }, postprocessResults: function () { var e = this.getVal(), t = this.results.find(".select2-result"), s = this.results.find(".select2-result-with-children"), i = this; t.each2(function (t, s) { p(i.id(s.data("select2-data")), e) >= 0 && (s.addClass("select2-selected"), s.find(".select2-result-selectable").addClass("select2-selected")) }), s.each2(function (e, t) { t.is(".select2-result-selectable") || 0 !== t.find(".select2-result-selectable:not(.select2-selected)").length || t.addClass("select2-selected") }), -1 === this.highlight() && i.highlight(0) }, getMaxSearchWidth: function () { return this.selection.width() - m(this.search) }, resizeSearch: function () { var t, s, i, n, o = m(this.search); t = function (t) { if (!a) { var s = t[0].currentStyle || window.getComputedStyle(t[0], null); (a = e(document.createElement("div")).css({ position: "absolute", left: "-10000px", top: "-10000px", display: "none", fontSize: s.fontSize, fontFamily: s.fontFamily, fontStyle: s.fontStyle, fontWeight: s.fontWeight, letterSpacing: s.letterSpacing, textTransform: s.textTransform, whiteSpace: "nowrap" })).attr("class", "select2-sizer"), e("body").append(a) } return a.text(t.val()), a.width() }(this.search) + 10, s = this.search.offset().left, (n = (i = this.selection.width()) - (s - this.selection.offset().left) - o) < t && (n = i - o), n < 40 && (n = i - o), n <= 0 && (n = t), this.search.width(n) }, getVal: function () { var e; return this.select ? null === (e = this.select.val()) ? [] : e : g(e = this.opts.element.val(), this.opts.separator) }, setVal: function (t) { var s; this.select ? this.select.val(t) : (s = [], e(t).each(function () { p(this, s) < 0 && s.push(this) }), this.opts.element.val(0 === s.length ? "" : s.join(this.opts.separator))) }, val: function () { var s, i = !1, n = this; if (0 === arguments.length) return this.getVal(); if (s = arguments[0], arguments.length > 1 && (i = arguments[1]), !s && 0 !== s) return this.opts.element.val(""), this.updateSelection([]), this.clearSearch(), void (i && this.triggerChange()); if (this.setVal(s), this.select) this.opts.initSelection(this.select, this.bind(this.updateSelection)), i && this.triggerChange(); else { if (this.opts.initSelection === t) throw new Error("val() cannot be called if initSelection() is not defined"); this.opts.initSelection(this.opts.element, function (t) { var s = e(t).map(n.id); n.setVal(s), n.updateSelection(t), n.clearSearch(), i && n.triggerChange() }) } this.clearSearch() }, onSortStart: function () { if (this.select) throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead."); this.search.width(0), this.searchContainer.hide() }, onSortEnd: function () { var t = [], s = this; this.searchContainer.show(), this.searchContainer.appendTo(this.searchContainer.parent()), this.resizeSearch(), this.selection.find(".select2-search-choice").each(function () { t.push(s.opts.id(e(this).data("select2-data"))) }), this.setVal(t), this.triggerChange() }, data: function (t) { var s, i = this; if (0 === arguments.length) return this.selection.find(".select2-search-choice").map(function () { return e(this).data("select2-data") }).get(); t || (t = []), s = e.map(t, function (e) { return i.opts.id(e) }), this.setVal(s), this.updateSelection(t), this.clearSearch() } }), e.fn.select2 = function () { var s, o, a, l, c = Array.prototype.slice.call(arguments, 0), r = ["val", "destroy", "opened", "open", "close", "focus", "isFocused", "container", "onSortStart", "onSortEnd", "enable", "disable", "positionDropdown", "data"]; return this.each(function () { if (0 === c.length || "object" == typeof c[0]) (s = 0 === c.length ? {} : e.extend({}, c[0])).element = e(this), "select" === s.element.get(0).tagName.toLowerCase() ? l = s.element.attr("multiple") : (l = s.multiple || !1, "tags" in s && (s.multiple = l = !0)), (o = l ? new n : new i).init(s); else { if ("string" != typeof c[0]) throw "Invalid arguments to select2 plugin: " + c; if (p(c[0], r) < 0) throw "Unknown method: " + c[0]; if (a = t, (o = e(this).data("select2")) === t) return; if ((a = "container" === c[0] ? o.container : o[c[0]].apply(o, c.slice(1))) !== t) return !1 } }), a === t ? this : a }, e.fn.select2.defaults = { width: "copy", loadMorePadding: 0, closeOnSelect: !0, openOnEnter: !0, containerCss: {}, dropdownCss: {}, containerCssClass: "", dropdownCssClass: "", formatResult: function (e, t, s, i) { var n = []; return y(e.text, s.term, n, i), n.join("") }, formatSelection: function (e, s) { return e ? e.text : t }, sortResults: function (e, t, s) { return e }, formatResultCssClass: function (e) { return t }, formatNoMatches: function () { return "No se encontraron coincidencias" }, formatInputTooShort: function (e, t) { var s = t - e.length; return "Please enter " + s + " more character" + (1 === s ? "" : "s") }, formatInputTooLong: function (e, t) { var s = e.length - t; return "Please delete " + s + " character" + (1 === s ? "" : "s") }, formatSelectionTooBig: function (e) { return "You can only select " + e + " item" + (1 === e ? "" : "s") }, formatLoadMore: function (e) { return "Loading more results..." }, formatSearching: function () { return "Buscando..." }, minimumResultsForSearch: 0, minimumInputLength: 0, maximumInputLength: null, maximumSelectionSize: 0, id: function (e) { return e.id }, matcher: function (e, t) { return ("" + t).toUpperCase().indexOf(("" + e).toUpperCase()) >= 0 }, separator: ",", tokenSeparators: [], tokenizer: function (e, s, i, n) { var o, a, l, c, r, h = e, d = !1; if (!n.createSearchChoice || !n.tokenSeparators || n.tokenSeparators.length < 1) return t; for (; ;) { for (a = -1, l = 0, c = n.tokenSeparators.length; l < c && (r = n.tokenSeparators[l], !((a = e.indexOf(r)) >= 0)) ; l++); if (a < 0) break; if (o = e.substring(0, a), e = e.substring(a + r.length), o.length > 0 && (o = n.createSearchChoice(o, s)) !== t && null !== o && n.id(o) !== t && null !== n.id(o)) { for (d = !1, l = 0, c = s.length; l < c; l++) if (f(n.id(o), n.id(s[l]))) { d = !0; break } d || i(o) } } return h !== e ? e : void 0 }, escapeMarkup: function (e) { var t = { "\\": "&#92;", "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&apos;", "/": "&#47;" }; return String(e).replace(/[&<>"'\/\\]/g, function (e) { return t[e[0]] }) }, blurOnChange: !1, selectOnBlur: !1, adaptContainerCssClass: function (e) { return e }, adaptDropdownCssClass: function (e) { return null } }, window.Select2 = { query: { ajax: x, local: E, tags: T }, util: { debounce: b, markMatch: y }, class: { abstract: s, single: i, multi: n } } } function p(e, t) { for (var s = 0, i = t.length; s < i; s += 1) if (f(e, t[s])) return s; return -1 } function f(e, s) { return e === s || e !== t && s !== t && (null !== e && null !== s && (e.constructor === String ? e + "" == s + "" : s.constructor === String && s + "" == e + "")) } function g(t, s) { var i, n, o; if (null === t || t.length < 1) return []; for (n = 0, o = (i = t.split(s)).length; n < o; n += 1) i[n] = e.trim(i[n]); return i } function m(e) { return e.outerWidth(!1) - e.width() } function v(s) { var i = "keyup-change-value"; s.bind("keydown", function () { e.data(s, i) === t && e.data(s, i, s.val()) }), s.bind("keyup", function () { var n = e.data(s, i); n !== t && s.val() !== n && (e.removeData(s, i), s.trigger("keyup-change")) }) } function b(e, s, i) { var n; return i = i || t, function () { var t = arguments; window.clearTimeout(n), n = window.setTimeout(function () { s.apply(i, t) }, e) } } function w(e) { e[0] !== document.activeElement && window.setTimeout(function () { var t, s = e[0], i = e.val().length; e.focus(), e.is(":visible") && s === document.activeElement && (s.setSelectionRange ? s.setSelectionRange(i, i) : s.createTextRange && ((t = s.createTextRange()).collapse(!1), t.select())) }, 0) } function C(e) { e.preventDefault(), e.stopPropagation() } function S(t, s, i) { var n, o = []; (n = t.attr("class")) && e((n = "" + n).split(" ")).each2(function () { 0 === this.indexOf("select2-") && o.push(this) }), (n = s.attr("class")) && e((n = "" + n).split(" ")).each2(function () { 0 !== this.indexOf("select2-") && i(this) && o.push(this) }), t.attr("class", o.join(" ")) } function y(e, t, s, i) { var n = e.toUpperCase().indexOf(t.toUpperCase()), o = t.length; n < 0 ? s.push(i(e)) : (s.push(i(e.substring(0, n))), s.push("<span class='select2-match'>"), s.push(i(e.substring(n, n + o))), s.push("</span>"), s.push(i(e.substring(n + o, e.length)))) } function x(t) { var s, i = 0, n = null, o = t.quietMillis || 100, a = t.url, l = this; return function (c) { window.clearTimeout(s), s = window.setTimeout(function () { var s = i += 1, o = t.data, r = a, h = t.transport || e.ajax, d = t.type || "GET", u = {}; o = o ? o.call(l, c.term, c.page, c.context) : null, r = "function" == typeof r ? r.call(l, c.term, c.page, c.context) : r, null !== n && n.abort(), t.params && (e.isFunction(t.params) ? e.extend(u, t.params.call(l)) : e.extend(u, t.params)), e.extend(u, { url: r, dataType: t.dataType, data: o, type: d, cache: !1, success: function (e) { if (!(s < i)) { var n = t.results(e, c.page); c.callback(n) } } }), n = h.call(l, u) }, o) } } function E(t) { var s, i, n = t, o = function (e) { return "" + e.text }; e.isArray(n) && (n = { results: i = n }), !1 === e.isFunction(n) && (i = n, n = function () { return i }); var a = n(); return a.text && (o = a.text, e.isFunction(o) || (s = n.text, o = function (e) { return e[s] })), function (t) { var s, i = t.term, a = { results: [] }; "" !== i ? (s = function (n, a) { var l, c; if ((n = n[0]).children) { l = {}; for (c in n) n.hasOwnProperty(c) && (l[c] = n[c]); l.children = [], e(n.children).each2(function (e, t) { s(t, l.children) }), (l.children.length || t.matcher(i, o(l), n)) && a.push(l) } else t.matcher(i, o(n), n) && a.push(n) }, e(n().results).each2(function (e, t) { s(t, a.results) }), t.callback(a)) : t.callback(n()) } } function T(s) { var i = e.isFunction(s); return function (n) { var o = n.term, a = { results: [] }; e(i ? s() : s).each(function () { var e = this.text !== t, s = e ? this.text : this; ("" === o || n.matcher(o, s)) && a.results.push(e ? this : { id: this, text: this }) }), n.callback(a) } } function P(t, s) { if (e.isFunction(t)) return !0; if (!t) return !1; throw new Error("formatterName must be a function or a falsy value") } function k(t) { return e.isFunction(t) ? t() : t } function O(t, s) { var i = function () { }; return (i.prototype = new t).constructor = i, i.prototype.parent = t.prototype, i.prototype = e.extend(i.prototype, s), i } }(jQuery);